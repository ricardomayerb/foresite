---
title: Brazil data
author: Ricardo Mayer
date: '2018-01-16'
categories:
  - data
tags:
  - data
  - Brazil
slug: brazil-data
---



<div id="data-sources-and-definition" class="section level2">
<h2>Data sources and definition</h2>
</div>
<div id="data-storage" class="section level2">
<h2>Data storage</h2>
</div>
<div id="data-exploration" class="section level2">
<h2>Data exploration</h2>
<div id="data-loading" class="section level3">
<h3>Data loading</h3>
<p>load</p>
<pre class="r"><code>country_q &lt;- read_excel(&quot;../../Brasil.xlsx&quot;, sheet = &quot;quarterly&quot;)
country_m &lt;- read_excel(&quot;../../Brasil.xlsx&quot;, sheet = &quot;monthly&quot;)</code></pre>
<p>clean up</p>
<pre class="r"><code>data_q &lt;- country_q %&gt;% select(-c(year, quarter, trim, hlookup)) %&gt;% 
  filter(!is.na(rgdp))

data_m &lt;- country_m %&gt;% select(-c(year, month,  hlookup)) 

data_q$date &lt;- ymd(data_q$date)
data_m$date &lt;- ymd(data_m$date)</code></pre>
<p>Three versions of the data set for different purposes: - multicolumn ts (mts) object - multicolumn xts object - a tibble with list column, to apply functions for each series and store results as another list column (think estimation model, results, etc)</p>
<pre class="r"><code>start_year_q &lt;- min(year(data_q$date))
start_year_m &lt;- min(year(data_m$date))

data_q_mts &lt;- tk_ts(data_q, start = start_year_q, frequency = 4)
data_q_xts &lt;- tk_xts(data_q, date_var = date)
data_q_tbt &lt;- as_tbl_time(data_q, index = date)
data_q_long &lt;- data_q %&gt;% gather(variable, value, -date)

data_q_nested &lt;- data_q_long %&gt;% group_by(variable) %&gt;% 
  nest(.key = &quot;data.tbl&quot;)
data_q_n_ts &lt;- data_q_nested %&gt;% 
  mutate(data.ts = map(.x   =  data.tbl,
                       .f   =  tk_ts,
                       start = start_year_q,
                       freq = 4
                       )
         )

data_m_mts &lt;- tk_ts(data_m, start = start_year_m, frequency = 12)
data_m_xts &lt;- tk_xts(data_m, date_var = date)
data_m_tbt &lt;- as_tbl_time(data_m, index = date)
data_m_long &lt;- data_m %&gt;% gather(variable, value, -date)

data_m_nested &lt;- data_m_long %&gt;% group_by(variable) %&gt;% 
  nest(.key = &quot;data.tbl&quot;)
data_m_n_ts &lt;- data_m_nested %&gt;% 
  mutate(data.ts = map(.x   =  data.tbl,
                       .f   =  tk_ts,
                       start = start_year_m,
                       freq = 12
                       )
         )</code></pre>
<p>Some plots</p>
<p>Quaterly variables</p>
<pre class="r"><code>plotbase_q &lt;- ggplot(data = data_q_long,
                     aes(x = date, y = value, colour = variable))  

plot_q &lt;- plotbase_q + geom_line() + 
  facet_wrap(~variable, scales = &quot;free_y&quot;, ncol = 3) 

plot_q</code></pre>
<p><img src="/post/2018-01-16-data-brazil_files/figure-html/plotq-1.png" width="672" /></p>
<p>Monthly variables</p>
<pre class="r"><code>plotbase_m &lt;- ggplot(data = data_m_long,
                     aes(x = date, y = value, colour = variable))  

plot_m &lt;- plotbase_m + geom_line() + 
  facet_wrap(~variable, scales = &quot;free_y&quot;, ncol = 3) 

plot_m</code></pre>
<p><img src="/post/2018-01-16-data-brazil_files/figure-html/plotm-1.png" width="672" /></p>
</div>
</div>
<div id="summary-of-properties" class="section level2">
<h2>Summary of properties</h2>
</div>
